{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "UFAI Results Schema",
  "description": "Standardized schema for benchmark results across all frameworks",
  "type": "object",
  "required": ["version", "timestamp", "framework", "stages", "overall"],
  "properties": {
    "version": {
      "type": "string",
      "description": "Results schema version",
      "enum": ["1.0", "1.1"],
      "default": "1.0"
    },
    "timestamp": {
      "type": "string",
      "description": "ISO 8601 timestamp of when the benchmark was run",
      "format": "date-time"
    },
    "benchmark": {
      "type": "object",
      "description": "Benchmark metadata",
      "properties": {
        "problem_id": {
          "type": "string",
          "description": "Problem identifier (e.g., WEB-001)",
          "pattern": "^[A-Z]+-\\d{3}$"
        },
        "runner_version": {
          "type": "string",
          "description": "Version of the benchmark runner"
        },
        "environment": {
          "type": "string",
          "description": "Execution environment",
          "enum": ["local", "docker", "kubernetes", "cloud"]
        }
      }
    },
    "framework": {
      "type": "object",
      "description": "Framework information",
      "required": ["name", "language"],
      "properties": {
        "name": {
          "type": "string",
          "description": "Framework name"
        },
        "version": {
          "type": "string",
          "description": "Framework version"
        },
        "language": {
          "type": "string",
          "description": "Programming language",
          "enum": ["python", "javascript", "typescript", "go", "rust", "java", "csharp", "ruby", "php", "other"]
        },
        "runtime": {
          "type": "string",
          "description": "Runtime version (e.g., Python 3.11, Node.js 20)"
        }
      }
    },
    "compliance": {
      "type": "object",
      "description": "Compliance information",
      "properties": {
        "level": {
          "type": "string",
          "description": "Achieved compliance level",
          "enum": ["L0", "L1", "L2", "L3", "L4", "L5"]
        },
        "score": {
          "type": "number",
          "description": "Compliance score (0-100)",
          "minimum": 0,
          "maximum": 100
        },
        "features": {
          "type": "array",
          "description": "Implemented features",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "stages": {
      "type": "object",
      "description": "Results for each benchmark stage",
      "properties": {
        "build": {
          "$ref": "#/definitions/stageResult"
        },
        "test": {
          "$ref": "#/definitions/testResult"
        },
        "performance": {
          "$ref": "#/definitions/performanceResult"
        },
        "security": {
          "$ref": "#/definitions/securityResult"
        },
        "lint": {
          "$ref": "#/definitions/stageResult"
        },
        "coverage": {
          "$ref": "#/definitions/coverageResult"
        }
      }
    },
    "overall": {
      "type": "object",
      "description": "Overall benchmark results",
      "required": ["score", "grade"],
      "properties": {
        "score": {
          "type": "number",
          "description": "Overall score (0-100)",
          "minimum": 0,
          "maximum": 100
        },
        "grade": {
          "type": "string",
          "description": "Letter grade",
          "enum": ["A+", "A", "B+", "B", "C+", "C", "D", "F"]
        },
        "status": {
          "type": "string",
          "description": "Overall status",
          "enum": ["pass", "fail", "partial"]
        },
        "badges": {
          "type": "array",
          "description": "Earned badges",
          "items": {
            "type": "string",
            "enum": ["performance", "security", "tested", "documented", "production-ready", "scalable", "maintainable"]
          }
        },
        "summary": {
          "type": "string",
          "description": "Human-readable summary"
        }
      }
    },
    "artifacts": {
      "type": "object",
      "description": "Generated artifacts",
      "properties": {
        "logs": {
          "type": "string",
          "description": "Path to execution logs"
        },
        "reports": {
          "type": "object",
          "description": "Generated reports",
          "properties": {
            "html": {
              "type": "string",
              "description": "Path to HTML report"
            },
            "json": {
              "type": "string",
              "description": "Path to detailed JSON report"
            },
            "markdown": {
              "type": "string",
              "description": "Path to Markdown report"
            }
          }
        },
        "coverage": {
          "type": "string",
          "description": "Path to coverage report"
        },
        "performance": {
          "type": "string",
          "description": "Path to performance data"
        },
        "security": {
          "type": "string",
          "description": "Path to security scan results"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata",
      "properties": {
        "duration": {
          "type": "number",
          "description": "Total execution time in seconds"
        },
        "host": {
          "type": "object",
          "description": "Host system information",
          "properties": {
            "os": {
              "type": "string"
            },
            "cpu": {
              "type": "string"
            },
            "memory": {
              "type": "string"
            },
            "arch": {
              "type": "string"
            }
          }
        },
        "git": {
          "type": "object",
          "description": "Git repository information",
          "properties": {
            "commit": {
              "type": "string"
            },
            "branch": {
              "type": "string"
            },
            "tag": {
              "type": "string"
            },
            "dirty": {
              "type": "boolean"
            }
          }
        }
      }
    }
  },
  "definitions": {
    "stageResult": {
      "type": "object",
      "required": ["status"],
      "properties": {
        "status": {
          "type": "string",
          "enum": ["success", "failed", "skipped", "timeout", "error"]
        },
        "duration": {
          "type": "number",
          "description": "Execution time in seconds"
        },
        "exit_code": {
          "type": "integer",
          "description": "Process exit code"
        },
        "stdout": {
          "type": "string",
          "description": "Standard output (truncated)"
        },
        "stderr": {
          "type": "string",
          "description": "Standard error (truncated)"
        },
        "error": {
          "type": "string",
          "description": "Error message if failed"
        },
        "metrics": {
          "type": "object",
          "description": "Stage-specific metrics",
          "additionalProperties": true
        }
      }
    },
    "testResult": {
      "allOf": [
        { "$ref": "#/definitions/stageResult" },
        {
          "properties": {
            "metrics": {
              "type": "object",
              "properties": {
                "total": {
                  "type": "integer",
                  "description": "Total number of tests"
                },
                "passed": {
                  "type": "integer",
                  "description": "Number of passed tests"
                },
                "failed": {
                  "type": "integer",
                  "description": "Number of failed tests"
                },
                "skipped": {
                  "type": "integer",
                  "description": "Number of skipped tests"
                },
                "pass_rate": {
                  "type": "number",
                  "description": "Percentage of tests passed",
                  "minimum": 0,
                  "maximum": 100
                },
                "suites": {
                  "type": "array",
                  "description": "Test suite results",
                  "items": {
                    "type": "object",
                    "properties": {
                      "name": { "type": "string" },
                      "passed": { "type": "integer" },
                      "failed": { "type": "integer" },
                      "duration": { "type": "number" }
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    "performanceResult": {
      "allOf": [
        { "$ref": "#/definitions/stageResult" },
        {
          "properties": {
            "metrics": {
              "type": "object",
              "properties": {
                "throughput": {
                  "type": "object",
                  "properties": {
                    "requests_per_second": {
                      "type": "number",
                      "description": "Average requests per second"
                    },
                    "transactions_per_second": {
                      "type": "number",
                      "description": "Average transactions per second"
                    },
                    "bytes_per_second": {
                      "type": "number",
                      "description": "Average bytes per second"
                    }
                  }
                },
                "latency": {
                  "type": "object",
                  "properties": {
                    "min": {
                      "type": "number",
                      "description": "Minimum latency in ms"
                    },
                    "max": {
                      "type": "number",
                      "description": "Maximum latency in ms"
                    },
                    "mean": {
                      "type": "number",
                      "description": "Mean latency in ms"
                    },
                    "median": {
                      "type": "number",
                      "description": "Median latency in ms"
                    },
                    "p50": {
                      "type": "number",
                      "description": "50th percentile latency in ms"
                    },
                    "p90": {
                      "type": "number",
                      "description": "90th percentile latency in ms"
                    },
                    "p95": {
                      "type": "number",
                      "description": "95th percentile latency in ms"
                    },
                    "p99": {
                      "type": "number",
                      "description": "99th percentile latency in ms"
                    }
                  }
                },
                "errors": {
                  "type": "object",
                  "properties": {
                    "total": {
                      "type": "integer",
                      "description": "Total number of errors"
                    },
                    "rate": {
                      "type": "number",
                      "description": "Error rate percentage",
                      "minimum": 0,
                      "maximum": 100
                    },
                    "types": {
                      "type": "object",
                      "description": "Error counts by type",
                      "additionalProperties": {
                        "type": "integer"
                      }
                    }
                  }
                },
                "concurrency": {
                  "type": "integer",
                  "description": "Number of concurrent users/connections"
                },
                "duration": {
                  "type": "number",
                  "description": "Test duration in seconds"
                },
                "requests": {
                  "type": "object",
                  "properties": {
                    "total": {
                      "type": "integer",
                      "description": "Total requests made"
                    },
                    "successful": {
                      "type": "integer",
                      "description": "Successful requests"
                    },
                    "failed": {
                      "type": "integer",
                      "description": "Failed requests"
                    }
                  }
                },
                "resources": {
                  "type": "object",
                  "properties": {
                    "cpu_usage": {
                      "type": "number",
                      "description": "Average CPU usage percentage"
                    },
                    "memory_usage": {
                      "type": "number",
                      "description": "Average memory usage in MB"
                    },
                    "disk_io": {
                      "type": "number",
                      "description": "Disk I/O in MB/s"
                    },
                    "network_io": {
                      "type": "number",
                      "description": "Network I/O in MB/s"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    "securityResult": {
      "allOf": [
        { "$ref": "#/definitions/stageResult" },
        {
          "properties": {
            "metrics": {
              "type": "object",
              "properties": {
                "vulnerabilities": {
                  "type": "object",
                  "properties": {
                    "critical": {
                      "type": "integer",
                      "description": "Number of critical vulnerabilities"
                    },
                    "high": {
                      "type": "integer",
                      "description": "Number of high vulnerabilities"
                    },
                    "medium": {
                      "type": "integer",
                      "description": "Number of medium vulnerabilities"
                    },
                    "low": {
                      "type": "integer",
                      "description": "Number of low vulnerabilities"
                    },
                    "info": {
                      "type": "integer",
                      "description": "Number of informational findings"
                    },
                    "total": {
                      "type": "integer",
                      "description": "Total number of vulnerabilities"
                    }
                  }
                },
                "compliance": {
                  "type": "object",
                  "properties": {
                    "score": {
                      "type": "number",
                      "description": "Compliance score (0-100)",
                      "minimum": 0,
                      "maximum": 100
                    },
                    "checks_passed": {
                      "type": "integer"
                    },
                    "checks_failed": {
                      "type": "integer"
                    },
                    "checks_total": {
                      "type": "integer"
                    }
                  }
                },
                "scan_type": {
                  "type": "string",
                  "enum": ["static", "dynamic", "dependency", "container", "mixed"]
                },
                "tools_used": {
                  "type": "array",
                  "description": "Security tools used",
                  "items": {
                    "type": "string"
                  }
                },
                "findings": {
                  "type": "array",
                  "description": "Top security findings",
                  "items": {
                    "type": "object",
                    "properties": {
                      "severity": {
                        "type": "string",
                        "enum": ["critical", "high", "medium", "low", "info"]
                      },
                      "type": {
                        "type": "string"
                      },
                      "description": {
                        "type": "string"
                      },
                      "file": {
                        "type": "string"
                      },
                      "line": {
                        "type": "integer"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      ]
    },
    "coverageResult": {
      "allOf": [
        { "$ref": "#/definitions/stageResult" },
        {
          "properties": {
            "metrics": {
              "type": "object",
              "properties": {
                "line_coverage": {
                  "type": "number",
                  "description": "Line coverage percentage",
                  "minimum": 0,
                  "maximum": 100
                },
                "branch_coverage": {
                  "type": "number",
                  "description": "Branch coverage percentage",
                  "minimum": 0,
                  "maximum": 100
                },
                "function_coverage": {
                  "type": "number",
                  "description": "Function coverage percentage",
                  "minimum": 0,
                  "maximum": 100
                },
                "statement_coverage": {
                  "type": "number",
                  "description": "Statement coverage percentage",
                  "minimum": 0,
                  "maximum": 100
                },
                "files": {
                  "type": "object",
                  "properties": {
                    "total": {
                      "type": "integer"
                    },
                    "covered": {
                      "type": "integer"
                    },
                    "uncovered": {
                      "type": "integer"
                    }
                  }
                },
                "lines": {
                  "type": "object",
                  "properties": {
                    "total": {
                      "type": "integer"
                    },
                    "covered": {
                      "type": "integer"
                    },
                    "uncovered": {
                      "type": "integer"
                    }
                  }
                }
              }
            }
          }
        }
      ]
    }
  }
}